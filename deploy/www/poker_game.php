<!DOCTYPE html>
<html>
<head>
    <script>
        var eventsJSON = JSON.parse('{"0":{"0":"0","1":"letsPoker"},"1":{"0":"0","1":"roundStarted 1"},"2":{"0":"0","1":"rmDealerButton 19"},"3":{"0":"0","1":"addDealerButton 28"},"4":{"0":"0","1":"dealing"},"5":{"0":"19","1":"receiveCard HEARTS ACE"},"6":{"0":"19","1":"receiveCard SPADES JACK"},"7":{"0":"0","1":"preflop"},"8":{"0":"0","1":"betRound"},"9":{"0":"47","1":"call"},"10":{"0":"50","1":"call"},"11":{"0":"19","1":"getHandRank"},"12":{"0":"19","1":"canCheck"},"13":{"0":"19","1":"getCallAmount"},"14":{"0":"19","1":"call"},"15":{"0":"19","1":"canCall"},"16":{"0":"28","1":"fold"},"17":{"0":"35","1":"call"},"18":{"0":"42","1":"call"},"19":{"0":"0","1":"burn DIAMONDS THREE"},"20":{"0":"0","1":"flop SPADES NINE,SPADES SIX,SPADES FIVE"},"21":{"0":"0","1":"betRound"},"22":{"0":"35","1":"raise 100"},"23":{"0":"42","1":"call"},"24":{"0":"47","1":"call"},"25":{"0":"50","1":"call"},"26":{"0":"19","1":"getHandRank"},"27":{"0":"19","1":"canCheck"},"28":{"0":"19","1":"getCallAmount"},"29":{"0":"19","1":"call"},"30":{"0":"19","1":"canCall"},"31":{"0":"0","1":"burn DIAMONDS SEVEN"},"32":{"0":"0","1":"turn SPADES DEUCE"},"33":{"0":"0","1":"betRound"},"34":{"0":"35","1":"raise 100"},"35":{"0":"42","1":"raise 100"},"36":{"0":"47","1":"raise 100"},"37":{"0":"50","1":"call"},"38":{"0":"19","1":"getHandRank"},"39":{"0":"19","1":"canCall"},"40":{"0":"19","1":"call"},"41":{"0":"19","1":"canCall"},"42":{"0":"35","1":"raise 100"},"43":{"0":"42","1":"raise 100"},"44":{"0":"47","1":"raise 100"},"45":{"0":"50","1":"fold"},"46":{"0":"19","1":"getHandRank"},"47":{"0":"19","1":"canCall"},"48":{"0":"19","1":"call"},"49":{"0":"19","1":"canCall"},"50":{"0":"35","1":"raise 100"},"51":{"0":"42","1":"call"},"52":{"0":"47","1":"call"},"53":{"0":"19","1":"getHandRank"},"54":{"0":"19","1":"canCall"},"55":{"0":"19","1":"call"},"56":{"0":"19","1":"canCall"},"57":{"0":"0","1":"burn SPADES SEVEN"},"58":{"0":"0","1":"river HEARTS SIX"},"59":{"0":"0","1":"betRound"},"60":{"0":"35","1":"check"},"61":{"0":"42","1":"check"},"62":{"0":"47","1":"check"},"63":{"0":"19","1":"getHandRank"},"64":{"0":"19","1":"canCall"},"65":{"0":"19","1":"canCheck"},"66":{"0":"19","1":"check"},"67":{"0":"19","1":"canCheck"},"68":{"0":"0","1":"showdown"},"69":{"0":"19","1":"revealCards HEARTS ACE,SPADES JACK"},"70":{"0":"35","1":"revealCards CLUBS NINE,CLUBS SIX"},"71":{"0":"42","1":"revealCards HEARTS SEVEN,SPADES QUEEN"},"72":{"0":"47","1":"revealCards HEARTS KING,HEARTS DEUCE"},"73":{"0":"0","1":"roundWinners 1,Schar"},"74":{"0":"0","1":"handOutPot 1,Schar"},"75":{"0":"0","1":"collectCards"},"76":{"0":"0","1":"roundEnded"},"77":{"0":"0","1":"roundStarted 2"},"78":{"0":"0","1":"rmDealerButton 28"},"79":{"0":"0","1":"addDealerButton 35"},"80":{"0":"0","1":"dealing"},"81":{"0":"19","1":"receiveCard CLUBS EIGHT"},"82":{"0":"19","1":"receiveCard DIAMONDS TEN"},"83":{"0":"0","1":"preflop"},"84":{"0":"0","1":"betRound"},"85":{"0":"50","1":"call"},"86":{"0":"19","1":"getHandRank"},"87":{"0":"19","1":"canCheck"},"88":{"0":"19","1":"getCallAmount"},"89":{"0":"19","1":"fold"},"90":{"0":"19","1":"canFold"},"91":{"0":"28","1":"fold"},"92":{"0":"35","1":"call"},"93":{"0":"42","1":"fold"},"94":{"0":"47","1":"fold"},"95":{"0":"0","1":"burn HEARTS FIVE"},"96":{"0":"0","1":"flop SPADES SIX,HEARTS KING,HEARTS NINE"},"97":{"0":"0","1":"betRound"},"98":{"0":"50","1":"check"},"99":{"0":"35","1":"check"},"100":{"0":"0","1":"burn DIAMONDS EIGHT"},"101":{"0":"0","1":"turn DIAMONDS DEUCE"},"102":{"0":"0","1":"betRound"},"103":{"0":"50","1":"check"},"104":{"0":"35","1":"check"},"105":{"0":"0","1":"burn SPADES JACK"},"106":{"0":"0","1":"river SPADES KING"},"107":{"0":"0","1":"betRound"},"108":{"0":"50","1":"check"},"109":{"0":"35","1":"raise 100"},"110":{"0":"50","1":"call"},"111":{"0":"0","1":"showdown"},"112":{"0":"35","1":"revealCards CLUBS TEN,CLUBS ACE"},"113":{"0":"50","1":"revealCards DIAMONDS FOUR,CLUBS SEVEN"},"114":{"0":"0","1":"roundWinners 1,Schar"},"115":{"0":"0","1":"handOutPot 1,Schar"},"116":{"0":"0","1":"collectCards"},"117":{"0":"0","1":"rebuyOrLeave 42"},"118":{"0":"0","1":"rebuyOrLeave 47"},"119":{"0":"0","1":"leave 42"},"120":{"0":"0","1":"leave 47"},"121":{"0":"0","1":"roundEnded"},"122":{"0":"0","1":"roundStarted 3"},"123":{"0":"0","1":"rmDealerButton 35"},"124":{"0":"0","1":"addDealerButton 50"},"125":{"0":"0","1":"dealing"},"126":{"0":"19","1":"receiveCard SPADES TEN"},"127":{"0":"19","1":"receiveCard DIAMONDS JACK"},"128":{"0":"0","1":"preflop"},"129":{"0":"0","1":"betRound"},"130":{"0":"35","1":"call"},"131":{"0":"50","1":"fold"},"132":{"0":"19","1":"getHandRank"},"133":{"0":"19","1":"canCheck"},"134":{"0":"19","1":"getCallAmount"},"135":{"0":"19","1":"fold"},"136":{"0":"19","1":"canFold"},"137":{"0":"28","1":"fold"},"138":{"0":"0","1":"handOutPot 1,Schar"},"139":{"0":"0","1":"collectCards"},"140":{"0":"0","1":"rebuyOrLeave 19"},"141":{"0":"19","1":"canRebuy 1"},"142":{"0":"0","1":"rebuyOrLeave 42"},"143":{"0":"0","1":"rebuyOrLeave 47"},"144":{"0":"0","1":"leave 19"},"145":{"0":"0","1":"leave 42"},"146":{"0":"0","1":"leave 47"},"147":{"0":"0","1":"roundEnded"},"148":{"0":"0","1":"roundStarted 4"},"149":{"0":"0","1":"rmDealerButton 50"},"150":{"0":"0","1":"addDealerButton 28"},"151":{"0":"0","1":"dealing"},"152":{"0":"0","1":"preflop"},"153":{"0":"0","1":"betRound"},"154":{"0":"28","1":"fold"},"155":{"0":"35","1":"call"},"156":{"0":"50","1":"call"},"157":{"0":"0","1":"burn CLUBS FOUR"},"158":{"0":"0","1":"flop HEARTS ACE,HEARTS JACK,SPADES FOUR"},"159":{"0":"0","1":"betRound"},"160":{"0":"35","1":"raise 100"},"161":{"0":"50","1":"fold"},"162":{"0":"0","1":"handOutPot 1,Schar"},"163":{"0":"0","1":"collectCards"},"164":{"0":"0","1":"rebuyOrLeave 19"},"165":{"0":"19","1":"canRebuy 1"},"166":{"0":"0","1":"rebuyOrLeave 42"},"167":{"0":"0","1":"rebuyOrLeave 47"},"168":{"0":"0","1":"leave 19"},"169":{"0":"0","1":"leave 42"},"170":{"0":"0","1":"leave 47"},"171":{"0":"0","1":"roundEnded"},"172":{"0":"0","1":"roundStarted 5"},"173":{"0":"0","1":"rmDealerButton 28"},"174":{"0":"0","1":"addDealerButton 35"},"175":{"0":"0","1":"dealing"},"176":{"0":"0","1":"preflop"},"177":{"0":"0","1":"betRound"},"178":{"0":"35","1":"call"},"179":{"0":"50","1":"allin"},"180":{"0":"28","1":"fold"},"181":{"0":"0","1":"burn SPADES ACE"},"182":{"0":"0","1":"flop SPADES DEUCE,HEARTS QUEEN,SPADES KING"},"183":{"0":"0","1":"betRound"},"184":{"0":"50","1":"allin"},"185":{"0":"50","1":"fold"},"186":{"0":"0","1":"handOutPot 1,Schar"},"187":{"0":"0","1":"collectCards"},"188":{"0":"0","1":"rebuyOrLeave 19"},"189":{"0":"19","1":"canRebuy 1"},"190":{"0":"0","1":"rebuyOrLeave 42"},"191":{"0":"0","1":"rebuyOrLeave 47"},"192":{"0":"0","1":"rebuyOrLeave 50"},"193":{"0":"0","1":"leave 19"},"194":{"0":"0","1":"leave 42"},"195":{"0":"0","1":"leave 47"},"196":{"0":"0","1":"leave 50"},"197":{"0":"0","1":"roundEnded"},"198":{"0":"0","1":"roundStarted 6"},"199":{"0":"0","1":"rmDealerButton 35"},"200":{"0":"0","1":"addDealerButton 28"},"201":{"0":"0","1":"dealing"},"202":{"0":"0","1":"preflop"},"203":{"0":"0","1":"betRound"},"204":{"0":"35","1":"call"},"205":{"0":"28","1":"fold"},"206":{"0":"0","1":"handOutPot 1,Schar"},"207":{"0":"0","1":"collectCards"},"208":{"0":"0","1":"rebuyOrLeave 19"},"209":{"0":"19","1":"canRebuy 1"},"210":{"0":"0","1":"rebuyOrLeave 42"},"211":{"0":"0","1":"rebuyOrLeave 47"},"212":{"0":"0","1":"rebuyOrLeave 50"},"213":{"0":"0","1":"leave 19"},"214":{"0":"0","1":"leave 42"},"215":{"0":"0","1":"leave 47"},"216":{"0":"0","1":"leave 50"},"217":{"0":"0","1":"roundEnded"},"218":{"0":"0","1":"roundStarted 7"},"219":{"0":"0","1":"rmDealerButton 28"},"220":{"0":"0","1":"addDealerButton 35"},"221":{"0":"0","1":"dealing"},"222":{"0":"0","1":"preflop"},"223":{"0":"0","1":"betRound"},"224":{"0":"28","1":"fold"},"225":{"0":"0","1":"handOutPot 1,Schar"},"226":{"0":"0","1":"collectCards"},"227":{"0":"0","1":"rebuyOrLeave 19"},"228":{"0":"19","1":"canRebuy 1"},"229":{"0":"0","1":"rebuyOrLeave 42"},"230":{"0":"0","1":"rebuyOrLeave 47"},"231":{"0":"0","1":"rebuyOrLeave 50"},"232":{"0":"0","1":"leave 19"},"233":{"0":"0","1":"leave 42"},"234":{"0":"0","1":"leave 47"},"235":{"0":"0","1":"leave 50"},"236":{"0":"0","1":"roundEnded"},"237":{"0":"0","1":"roundStarted 8"},"238":{"0":"0","1":"rmDealerButton 35"},"239":{"0":"0","1":"addDealerButton 28"},"240":{"0":"0","1":"dealing"},"241":{"0":"0","1":"preflop"},"242":{"0":"0","1":"betRound"},"243":{"0":"35","1":"call"},"244":{"0":"28","1":"fold"},"245":{"0":"0","1":"handOutPot 1,Schar"},"246":{"0":"0","1":"collectCards"},"247":{"0":"0","1":"rebuyOrLeave 19"},"248":{"0":"19","1":"canRebuy 1"},"249":{"0":"0","1":"rebuyOrLeave 42"},"250":{"0":"0","1":"rebuyOrLeave 47"},"251":{"0":"0","1":"rebuyOrLeave 50"},"252":{"0":"0","1":"leave 19"},"253":{"0":"0","1":"leave 42"},"254":{"0":"0","1":"leave 47"},"255":{"0":"0","1":"leave 50"},"256":{"0":"0","1":"roundEnded"},"257":{"0":"0","1":"roundStarted 9"},"258":{"0":"0","1":"rmDealerButton 28"},"259":{"0":"0","1":"addDealerButton 35"},"260":{"0":"0","1":"dealing"},"261":{"0":"0","1":"preflop"},"262":{"0":"0","1":"betRound"},"263":{"0":"28","1":"fold"},"264":{"0":"0","1":"handOutPot 1,Schar"},"265":{"0":"0","1":"collectCards"},"266":{"0":"0","1":"rebuyOrLeave 19"},"267":{"0":"19","1":"canRebuy 1"},"268":{"0":"0","1":"rebuyOrLeave 42"},"269":{"0":"0","1":"rebuyOrLeave 47"},"270":{"0":"0","1":"rebuyOrLeave 50"},"271":{"0":"0","1":"leave 19"},"272":{"0":"0","1":"leave 42"},"273":{"0":"0","1":"leave 47"},"274":{"0":"0","1":"leave 50"},"275":{"0":"0","1":"roundEnded"},"276":{"0":"0","1":"roundStarted 10"},"277":{"0":"0","1":"rmDealerButton 35"},"278":{"0":"0","1":"addDealerButton 28"},"279":{"0":"0","1":"dealing"},"280":{"0":"0","1":"preflop"},"281":{"0":"0","1":"betRound"},"282":{"0":"35","1":"call"},"283":{"0":"28","1":"fold"},"284":{"0":"0","1":"handOutPot 1,Schar"},"285":{"0":"0","1":"collectCards"},"286":{"0":"0","1":"rebuyOrLeave 19"},"287":{"0":"19","1":"canRebuy 1"},"288":{"0":"0","1":"rebuyOrLeave 42"},"289":{"0":"0","1":"rebuyOrLeave 47"},"290":{"0":"0","1":"rebuyOrLeave 50"},"291":{"0":"0","1":"leave 19"},"292":{"0":"0","1":"leave 42"},"293":{"0":"0","1":"leave 47"},"294":{"0":"0","1":"leave 50"},"295":{"0":"0","1":"roundEnded"},"296":{"0":"0","1":"roundStarted 11"},"297":{"0":"0","1":"rmDealerButton 28"},"298":{"0":"0","1":"addDealerButton 35"},"299":{"0":"0","1":"dealing"},"300":{"0":"0","1":"preflop"},"301":{"0":"0","1":"betRound"},"302":{"0":"28","1":"fold"},"303":{"0":"0","1":"handOutPot 1,Schar"},"304":{"0":"0","1":"collectCards"},"305":{"0":"0","1":"rebuyOrLeave 19"},"306":{"0":"19","1":"canRebuy 1"},"307":{"0":"0","1":"rebuyOrLeave 42"},"308":{"0":"0","1":"rebuyOrLeave 47"},"309":{"0":"0","1":"rebuyOrLeave 50"},"310":{"0":"0","1":"leave 19"},"311":{"0":"0","1":"leave 42"},"312":{"0":"0","1":"leave 47"},"313":{"0":"0","1":"leave 50"},"314":{"0":"0","1":"roundEnded"},"315":{"0":"0","1":"roundStarted 12"},"316":{"0":"0","1":"rmDealerButton 35"},"317":{"0":"0","1":"addDealerButton 28"},"318":{"0":"0","1":"dealing"},"319":{"0":"0","1":"preflop"},"320":{"0":"0","1":"betRound"},"321":{"0":"35","1":"call"},"322":{"0":"28","1":"fold"},"323":{"0":"0","1":"handOutPot 1,Schar"},"324":{"0":"0","1":"collectCards"},"325":{"0":"0","1":"rebuyOrLeave 19"},"326":{"0":"19","1":"canRebuy 1"},"327":{"0":"0","1":"rebuyOrLeave 42"},"328":{"0":"0","1":"rebuyOrLeave 47"},"329":{"0":"0","1":"rebuyOrLeave 50"},"330":{"0":"0","1":"leave 19"},"331":{"0":"0","1":"leave 42"},"332":{"0":"0","1":"leave 47"},"333":{"0":"0","1":"leave 50"},"334":{"0":"0","1":"roundEnded"},"335":{"0":"0","1":"roundStarted 13"},"336":{"0":"0","1":"rmDealerButton 28"},"337":{"0":"0","1":"addDealerButton 35"},"338":{"0":"0","1":"dealing"},"339":{"0":"0","1":"preflop"},"340":{"0":"0","1":"betRound"},"341":{"0":"28","1":"fold"},"342":{"0":"0","1":"handOutPot 1,Schar"},"343":{"0":"0","1":"collectCards"},"344":{"0":"0","1":"rebuyOrLeave 19"},"345":{"0":"19","1":"canRebuy 1"},"346":{"0":"0","1":"rebuyOrLeave 42"},"347":{"0":"0","1":"rebuyOrLeave 47"},"348":{"0":"0","1":"rebuyOrLeave 50"},"349":{"0":"0","1":"leave 19"},"350":{"0":"0","1":"leave 42"},"351":{"0":"0","1":"leave 47"},"352":{"0":"0","1":"leave 50"},"353":{"0":"0","1":"roundEnded"},"354":{"0":"0","1":"roundStarted 14"},"355":{"0":"0","1":"rmDealerButton 35"},"356":{"0":"0","1":"addDealerButton 28"},"357":{"0":"0","1":"dealing"},"358":{"0":"0","1":"preflop"},"359":{"0":"0","1":"betRound"},"360":{"0":"35","1":"call"},"361":{"0":"28","1":"fold"},"362":{"0":"0","1":"handOutPot 1,Schar"},"363":{"0":"0","1":"collectCards"},"364":{"0":"0","1":"rebuyOrLeave 19"},"365":{"0":"19","1":"canRebuy 1"},"366":{"0":"0","1":"rebuyOrLeave 42"},"367":{"0":"0","1":"rebuyOrLeave 47"},"368":{"0":"0","1":"rebuyOrLeave 50"},"369":{"0":"0","1":"leave 19"},"370":{"0":"0","1":"leave 42"},"371":{"0":"0","1":"leave 47"},"372":{"0":"0","1":"leave 50"},"373":{"0":"0","1":"roundEnded"},"374":{"0":"0","1":"roundStarted 15"},"375":{"0":"0","1":"rmDealerButton 28"},"376":{"0":"0","1":"addDealerButton 35"},"377":{"0":"0","1":"dealing"},"378":{"0":"0","1":"preflop"},"379":{"0":"0","1":"betRound"},"380":{"0":"28","1":"allin"},"381":{"0":"35","1":"call"},"382":{"0":"0","1":"burn HEARTS SIX"},"383":{"0":"0","1":"flop SPADES FIVE,DIAMONDS FIVE,CLUBS JACK"},"384":{"0":"0","1":"betRound"},"385":{"0":"28","1":"allin"},"386":{"0":"28","1":"fold"},"387":{"0":"0","1":"handOutPot 1,Schar"},"388":{"0":"0","1":"collectCards"},"389":{"0":"0","1":"rebuyOrLeave 19"},"390":{"0":"19","1":"canRebuy 1"},"391":{"0":"0","1":"rebuyOrLeave 28"},"392":{"0":"0","1":"rebuyOrLeave 42"},"393":{"0":"0","1":"rebuyOrLeave 47"},"394":{"0":"0","1":"rebuyOrLeave 50"},"395":{"0":"0","1":"leave 19"},"396":{"0":"0","1":"leave 28"},"397":{"0":"0","1":"leave 42"},"398":{"0":"0","1":"leave 47"},"399":{"0":"0","1":"leave 50"},"400":{"0":"0","1":"roundEnded"},"401":{"0":"0","1":"gameWinner 35"}}');
        var myBotID = 19;
        var botsJSON = JSON.parse('{"0":{"0":"19","1":"Jonas"},"1":{"0":"47","1":"Sajtos"},"2":{"0":"50","1":"BotMan"},"3":{"0":"28","1":"MyBot11"},"4":{"0":"35","1":"Schar"},"5":{"0":"42","1":"CsikiBot"}}');
    </script>
    <script src="scripts/createjs-2013.12.12.min.js"></script>
    <script>
        var eventsJSONLen = 0;
        var suits = ["HEARTS", "DIAMONDS", "CLUBS", "SPADES"];
        var ranks = ["DEUCE", "THREE", "FOUR", "FIVE", "SIX", "SEVEN", "EIGHT",
    					"NINE", "TEN", "JACK", "QUEEN", "KING", "ACE"];
        var cardNames = [];

        var stage;
        var loadqueue;

        var loadComleted = false;

        var loadingCircle;
        var loadingCircleGoesLeft = false;
        var loadingText;

        var running = false;
        var animationRunning = false;

        var cardScale = 0.3;
        var cardsSpriteSheet;

        var playerPositions = [[260, 342], [79, 328], [44, 142], [146, 60], [490, 141], [440, 330]];
        var cardPositions = [[225, 262], [110, 262], [52, 177], [140, 100], [407, 177], [340, 262]];
        var dealerPosition = [275, 130];

        var cardsOnTable = [];
        var cardsOnTablePosition = [170, 177];

        var dealerButton;
        var dealerButtonOwner;

        var bots = {};

        var animations = [];
        var speed = 0.2;

        var currentEventNum = -1;

        function Bot(botID) {
            this.botID = botID;
            this.cards = [];
            this.name = "Bot";
            this.chips = 2000;
            this.nameText = null;
            this.chipsText = null;
            this.seat = 0;
        }

        function init() {
            stage = new createjs.Stage("demoCanvas");

            createjs.Ticker.addEventListener("tick", tick);
            createjs.Ticker.setFPS(40);

            loadqueue = new createjs.LoadQueue(false);
            loadqueue.on("complete", downLoadFinished, this);
            loadqueue.loadManifest([
     			{ id: "table", src: "images/game/table.png" },
     			{ id: "cards", src: "images/cards.png" },
     			{ id: "dealer", src: "images/game/dealer_button.png" }
            ]);

            loadingText = new createjs.Text("Please wait", "20px Arial", "#ffffff");
            loadingText.x = stage.canvas.width / 2 - loadingText.getBounds().width / 2;
            loadingText.y = stage.canvas.height / 2 - 50;
            loadingText.textBaseline = "top";
            stage.addChild(loadingText);

            loadingCircle = new createjs.Shape();
            loadingCircle.graphics.beginFill("blue").drawCircle(0, 0, 5);
            loadingCircle.x = 200;
            loadingCircle.y = stage.canvas.height / 2;
            stage.addChild(loadingCircle);

            for (var s = 0; s < suits.length; ++s) {
                for (r = 0; r < ranks.length; ++r) {
                    cname = suits[s] + " " + ranks[r];
                    cardNames.push(cname);
                }
            }
            cardNames.push('NULL NULL');

            stage.on("stagemouseup", function (evt) {
                console.log("stageX/Y: " + evt.stageX + "," + evt.stageY); // always in bounds
            });

            for (var k in eventsJSON) {
                eventsJSONLen++;
            }

            playGame();
        }

        function tick(event) {
            if (!loadComleted) {
                if (loadingCircleGoesLeft && loadingCircle.x < 200) { loadingCircleGoesLeft = !loadingCircleGoesLeft; }
                else if (!loadingCircleGoesLeft && loadingCircle.x > stage.canvas.width - 200) { loadingCircleGoesLeft = !loadingCircleGoesLeft; }
                loadingCircle.x += event.delta / 2 * (loadingCircleGoesLeft ? -1 : 1);
            }
            if (running && !animationRunning) {
                if (animations.length != 0) {
                    playNextAnimation();
                }
                else if (currentEventNum != eventsJSONLen - 1) {
                    currentEventNum++;
                    parseEvent(eventsJSON[currentEventNum]);
                }
            }
            stage.update();
        }

        function downLoadFinished() {
            loadComleted = true;
            stage.removeChild(loadingCircle);
            stage.removeChild(loadingText);

            var bmp = new createjs.Bitmap(loadqueue.getResult("table"));
            bmp.cache(0, 0, 410, 221);

            bmp.x = stage.canvas.width / 2 - bmp.getBounds().width / 2;
            bmp.y = 100;
            stage.addChild(bmp);

            dealerButton = new createjs.Bitmap(loadqueue.getResult("dealer"));
            dealerButton.cache(0, 0, 25, 25);
            dealerButton.x = -100;
            stage.addChild(dealerButton);

            var data = {
                images: [loadqueue.getResult("cards")],
                frames: { width: 125, height: 181, count: 58, regX: 0, regY: 0 }
            };
            cardsSpriteSheet = new createjs.SpriteSheet(data);
        }

        function playNextAnimation() {
            animationRunning = false;
            if (running) {
                if (animations.length != 0) {
                    animationRunning = true;
                    var a = animations.shift();
                    a();
                }
            }
        }

        function playGame() {
            running = true;
        }

        function parseEvent(event) {
            var logger = event[0];
            var params = event[1].split(",");
            var functionName;
            if (params.length == 1) {
                params = event[1].split(" ");
                functionName = params.splice(0, 1)[0];
            }
            else {
                //get function name
                var a = params[0].split(" ");
                functionName = a.splice(0, 1)[0];
                //cut function name from the first element in array
                params[0] = params[0].substring(functionName.length + 1);
                params = [params];
            }
            if (logger != "0")
                params.splice(0, 0, logger)
            if (functionName.indexOf("get") != 0 && functionName.indexOf("can") != 0)
            executeFunctionByName(functionName, window, params);
        }

        function executeFunctionByName(functionName, context, argsArray) {
            //var argsArray = [].slice.call(arguments).splice(2);
            var namespaces = functionName.split(".");
            var func = namespaces.pop();
            for (var i = 0; i < namespaces.length; i++) {
                context = context[namespaces[i]];
            }
            if (context[func] == undefined)
                alert(functionName);
            return context[func].apply(this, argsArray);
        }

        function animateMessage(message) {
            var t = new createjs.Text(message, "14px Arial", "#FFFFFF");
            t.x = stage.canvas.width / 2 - t.getBounds().width / 2;
            t.y = 40;
            t.textBaseline = "top";
            stage.addChild(t);
            var f = function animate() {
                createjs.Tween.get(t)
			         .to({ y: 60 }, 300 * speed).wait(1000 * speed).to({ alpha: 0, visible: false }, 200 * speed)
			         .call(removeText)
			         .call(playNextAnimation);
                function removeText() {
                    stage.removeChild(t);
                }
            }
            animations.push(f);
        }

        function showMessageAtBot(bot, message) {
            var t = new createjs.Text(message, "20px Arial", "#FFFFFF");

            t.x = bot.cards[0].x + 24;
            t.y = bot.cards[0].y + 10;
            t.textBaseline = "top";

            var b = new createjs.Shape();
            b.graphics.beginFill("#5286ff").drawRoundRect(0, 0, t.getBounds().width + 4, t.getBounds().height + 4, 5);
            b.x = t.x - 2;
            b.y = t.y - 2;
            stage.addChild(b);
            stage.addChild(t);
            var f = function animate() {
                createjs.Tween.get(b)
                        .wait(1000 * speed).to({ alpha: 0, visible: false }, 200 * speed);
                createjs.Tween.get(t)
			         .wait(1000 * speed).to({ alpha: 0, visible: false }, 200 * speed)
                     .call(removeText)
			         .call(playNextAnimation);
                function removeText() {
                    stage.removeChild(t);
                    stage.removeChild(b);
                }
            }
            animations.push(f);
        }

        function letsPoker() {
            for (var key in botsJSON) {
                var bot = new Bot(parseInt(botsJSON[key][0]));
                bot.name = botsJSON[key][1];
                bot.seat = parseInt(key);
                bot.nameText = new createjs.Text(bot.name, "14px Arial", "#FFFFFF");
                bot.nameText.x = playerPositions[bot.seat][0] - bot.nameText.getBounds().width / 2;
                bot.nameText.y = playerPositions[bot.seat][1];
                bot.nameText.textBaseline = "top";
                stage.addChild(bot.nameText);

                bot.chipsText = new createjs.Text(bot.chips, "bold 18px Arial", "#CC0000");
                bot.chipsText.x = bot.nameText.x;
                bot.chipsText.y = bot.nameText.y + 16;
                bot.chipsText.textBaseline = "top";
                stage.addChild(bot.chipsText);

                bots[bot.botID] = bot;
            }
        }

        function roundStarted(roundNum) {
            animateMessage("Round #" + roundNum + "started");
        }

        function dealing() {
            animateMessage("Dealing");
            function makeFunc(bot, right) {
                return function () {
                    var card = createCardSprite(52, bot.seat, right);
                    var oldX = card.x;
                    var oldY = card.y;
                    card.x = dealerPosition[0];
                    card.y = dealerPosition[1];
                    stage.addChild(card);
                    createjs.Tween.get(card)
				         .to({ x: oldX, y: oldY }, 100 * speed)
				         .call(playNextAnimation);
                    bot.cards[right ? 1 : 0] = card;
                }
            }
            for (var key in bots) {
                animations.push(makeFunc(bots[key], false));
            }

            for (var key in bots) {
                animations.push(makeFunc(bots[key], true));
            }
        }

        function receiveCard(logger, suite, rank) {
            var cardID = cardNames.indexOf(suite + " " + rank);
            for (var key in bots) {
                if (bots[key].botID == myBotID) {
                    var bot = bots[key];
                    if (bot.cards[0].currentFrame == 52) {
                        var card = createCardSprite(cardID, bot.seat, false);
                        stage.removeChild(bot.cards[0]);
                        bot.cards[0] = card;

                        stage.addChild(card);
                    }
                    else if (bot.cards[1].currentFrame == 52) {
                        var card = createCardSprite(cardID, bot.seat, true);
                        stage.removeChild(bot.cards[1]);
                        bot.cards[1] = card;

                        stage.addChild(card);
                    }
                }
            }
        }

        function rmDealerButton(botID) {
            dealerButtonOwner = null;

            var f = function () {
                createjs.Tween.get(dealerButton)
			         .to({ x: stage.canvas.width / 2 - dealerButton.getBounds().width / 2, y: -100 }, 100 * speed)
			         .call(playNextAnimation);
            }
            animations.push(f);
        }

        function addDealerButton(botID) {
            dealerButtonOwner = bots[botID];
            var f = function () {
                createjs.Tween.get(dealerButton)
			         .to({ x: playerPositions[dealerButtonOwner.seat][0] - dealerButton.getBounds().width / 2, y: playerPositions[dealerButtonOwner.seat][1] - 30 }, 100 * speed)
			         .call(playNextAnimation);
            }
            animations.push(f);
        }

        function call(logger, amount) {
            showMessageAtBot(bots[logger], "Call");
        }

        function fold(logger) {
            showMessageAtBot(bots[logger], "Dold");
        }

        function burn(suite, rank) {
            animateMessage("burn");
        }

        function flop(cards) {
            animateMessage("Flop");
            function makeFunc(cardID) {
                return function () {
                    var card = new createjs.Sprite(cardsSpriteSheet);
                    card.gotoAndStop(cardID);
                    card.scaleX = card.scaleY = cardScale;
                    card.x = cardsOnTablePosition[0] + cardsOnTable.length * (card.getTransformedBounds().width + 3);
                    card.y = cardsOnTablePosition[1];
                    var oldX = card.x;
                    var oldY = card.y;
                    card.x = dealerPosition[0];
                    card.y = dealerPosition[1];
                    stage.addChild(card);
                    createjs.Tween.get(card)
				         .to({ x: oldX, y: oldY }, 100 * speed)
				         .call(playNextAnimation);
                    cardsOnTable.push(card);
                }
            }
            for (var key in cards) {
                var a = cards[key].split(" ");
                var cardID = cardNames.indexOf(a[0] + " " + a[1]);
                animations.push(makeFunc(cardID));
            }
        }

        function turn(suite, rank) {
            animateMessage("Turn");
            animations.push(function () {
                var card = new createjs.Sprite(cardsSpriteSheet);
                card.gotoAndStop(cardNames.indexOf(suite + " " + rank));
                card.scaleX = card.scaleY = cardScale;
                card.x = cardsOnTablePosition[0] + cardsOnTable.length * (card.getTransformedBounds().width + 3);
                card.y = cardsOnTablePosition[1];
                var oldX = card.x;
                var oldY = card.y;
                card.x = dealerPosition[0];
                card.y = dealerPosition[1];
                stage.addChild(card);
                createjs.Tween.get(card)
                     .to({ x: oldX, y: oldY }, 100 * speed)
                     .call(playNextAnimation);
                cardsOnTable.push(card);
            });
        }

        function river(suite, rank) {
            animateMessage("River");
            animations.push(function () {
                var card = new createjs.Sprite(cardsSpriteSheet);
                card.gotoAndStop(cardNames.indexOf(suite + " " + rank));
                card.scaleX = card.scaleY = cardScale;
                card.x = cardsOnTablePosition[0] + cardsOnTable.length * (card.getTransformedBounds().width + 3);
                card.y = cardsOnTablePosition[1];
                var oldX = card.x;
                var oldY = card.y;
                card.x = dealerPosition[0];
                card.y = dealerPosition[1];
                stage.addChild(card);
                createjs.Tween.get(card)
                     .to({ x: oldX, y: oldY }, 100 * speed)
                     .call(playNextAnimation);
                cardsOnTable.push(card);
            });
        }

        function check(logger) {
            showMessageAtBot(bots[logger], "Check");
        }

        function raise(logger, amount) {
            showMessageAtBot(bots[logger], "Raise " + amount);
        }

        function allin(logger) {
            showMessageAtBot(bots[logger], "All in");
        }

        function revealCards(logger, array) {
            var bot = bots[logger];
            showMessageAtBot(bot, "revealCards");

            for (var i = 0; i < 2; i++) {
                var a = array[i].split(" ");
                var cardID = cardNames.indexOf(a[0] + " " + a[1]);
                var card = createCardSprite(cardID, bot.seat, i != 0);
                stage.removeChild(bot.cards[i]);
                bot.cards[i] = card;
                stage.addChild(card);
            }
        }

        function showdown() {
            animateMessage("Showdown");
        }

        function roundWinners(arr) {
            animateMessage("roundWinners");
        }

        function handOutPot(arr) {
            animateMessage("handOutPot");
        }

        function gameWinner(botID) {
            animateMessage("Won: " + bots[botID].name);
        }

        function collectCards(arr) {
            animateMessage("collectCards");
            for (var key in cardsOnTable) {
                stage.removeChild(cardsOnTable[key]);
            }
            cardsOnTable = [];
            for (var key in bots) {
                for(var k in bots[key].cards)
                {
                    stage.removeChild(bots[key].cards[k]);
                }
            }
        }

        function roundEnded() {
            animateMessage("Round ended");
        }

        function rebuyOrLeave(botID) {

        }

        function leave(botID) {

        }

        function preflop() {
        }

        function betRound() {
        }

        function createCardSprite(id, seat, isRight) {
            var card = new createjs.Sprite(cardsSpriteSheet);
            card.gotoAndStop(id);
            card.scaleX = card.scaleY = cardScale;
            if (!isRight)
                card.x = cardPositions[seat][0];
            else
                card.x = cardPositions[seat][0] + card.getTransformedBounds().width + 3;
            card.y = cardPositions[seat][1];
            return card;
        }

    </script>
</head>
<body onload="init();">
    <canvas id="demoCanvas" width="530" height="500" style="background-color:#333333">
        <?= $tr["GAME_BROWSER_INCOMPATIBLE"] ?>
    </canvas>
</body>
</html>